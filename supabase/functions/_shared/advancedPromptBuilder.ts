import { TrainingExample } from "./smartTrainingExamples.ts";

interface PromptConfig {
  subTopic: string;
  difficulty: 'easy' | 'medium' | 'hard';
  count: number;
  examples: TrainingExample[];
  section: 'ููู' | 'ููุธู';
  topic: string;
}

const DIFFICULTY_GUIDELINES = {
  easy: {
    description: 'ุฃุณุฆูุฉ ูุจุงุดุฑุฉุ ุฎุทูุฉ ุญุณุงุจูุฉ ูุงุญุฏุฉุ ููุงููู ุฃุณุงุณูุฉ',
    cognitive_level: 'ุชุฐูุฑ ูููู',
    steps: '1-2 ุฎุทูุฉ',
    time: '30-45 ุซุงููุฉ',
    complexity: 'ุจุณูุท ููุจุงุดุฑ'
  },
  medium: {
    description: 'ุฎุทูุชูู ุญุณุงุจูุชููุ ุฑุจุท ุจูู ููุงูููุ ุงุณุชูุชุงุฌ ุจุณูุท',
    cognitive_level: 'ุชุทุจูู ูุชุญููู',
    steps: '2-3 ุฎุทูุงุช',
    time: '60-90 ุซุงููุฉ',
    complexity: 'ูุชูุณุท ูุชุทูุจ ุชูููุฑ'
  },
  hard: {
    description: 'ุนุฏุฉ ุฎุทูุงุชุ ุชุญููู ุนูููุ ุฏูุฌ ููุงููู ูุชุนุฏุฏุฉุ ุงุณุชูุชุงุฌ ูุนูุฏ',
    cognitive_level: 'ุชุญููู ูุชูููู ูุฅุจุฏุงุน',
    steps: '3-5 ุฎุทูุงุช',
    time: '90-120 ุซุงููุฉ',
    complexity: 'ูุนูุฏ ูุชุทูุจ ุชุญููู ุนููู'
  }
};

const MATH_FORMATTING_RULES = `
## โ๏ธ ููุงุนุฏ ุงูุชูุณูู ุงูุฑูุงุถู (ุฅูุฒุงููุฉ):

### 1. ุงูุฃูุณูุณ - ุงูุชุจ ุงูุฃุณ ูู superscript:
   - โ ุฎุทุฃ: x^2, ุณ^2, 10^3, n^2
   - โ ุตุญูุญ: xยฒ, ุณยฒ, 10ยณ, nยฒ
   - ุงูุฃูุณูุณ ุงููุชุงุญุฉ: โฐ ยน ยฒ ยณ โด โต โถ โท โธ โน โฟ โบ โป
   
### 2. ุงููุชุบูุฑุงุช - ุงุณุชุฎุฏู ุงูุญุฑูู ุงูุนุฑุจูุฉ:
   - โ ุฎุทุฃ: x, y, z, a, b, n
   - โ ุตุญูุญ: ุณุ ุตุ ุนุ ุฃุ ุจุ ู
   - ุฎุฑูุทุฉ ุงูุชุญููู: xโุณุ yโุตุ zโุนุ aโุฃุ bโุจุ nโูุ mโู
   
### 3. ุงูุฌุฐูุฑ:
   - โ ุฎุทุฃ: sqrt(4), sqrt(x)
   - โ ุตุญูุญ: โ4ุ โุณ
   
### 4. ุงูุฑููุฒ ุงูุฑูุงุถูุฉ:
   | ุงุณุชุฎุฏู | ุจุฏูุงู ูู | ุงููุนูู |
   |--------|----------|--------|
   | ร | * ุฃู x | ุงูุถุฑุจ |
   | รท | / | ุงููุณูุฉ |
   | ยฑ | +/- | ุฒุงุฆุฏ ุฃู ูุงูุต |
   | โค | <= | ุฃุตุบุฑ ุฃู ูุณุงูู |
   | โฅ | >= | ุฃูุจุฑ ุฃู ูุณุงูู |
   | โ | != | ูุง ูุณุงูู |
   | ฯ | pi | ุจุงู |
   | โ | infinity | ูุง ูุง ููุงูุฉ |
   
### 5. ุงููุณูุฑ ุงูุดุงุฆุนุฉ:
   - โ ุฎุทุฃ: 1/2, 1/4, 3/4
   - โ ุตุญูุญ: ยฝุ ยผุ ยพ

### ุฃูุซูุฉ:
   - โ "x^2 + 5x - 6 = 0"
   - โ "ุณยฒ + 5ุณ - 6 = 0"
   - โ "sqrt(16) = 4"
   - โ "โ16 = 4"
   - โ "a^n * a^m = a^(n+m)"
   - โ "ุฃโฟ ร ุฃแต = ุฃโฟโบแต"
`;

const QUANTITATIVE_RULES = `
## ููุงุนุฏ ุงูุฃุณุฆูุฉ ุงููููุฉ:
1. ุงุณุชุฎุฏู ุฃุฑูุงู ูุงูุนูุฉ ูููุทููุฉ (ุชุฌูุจ ุงูุฃุนุฏุงุฏ ุงูุนุดูุงุฆูุฉ ุงููุจูุฑุฉ)
2. ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ ูุฌุจ ุฃู ุชููู ูุชูุฌุฉ ุฃุฎุทุงุก ุดุงุฆุนุฉ:
   - ุฎุทุฃ ูู ุงูุฅุดุงุฑุฉ (+/-)
   - ูุณูุงู ุฎุทูุฉ ุญุณุงุจูุฉ
   - ุฎูุท ุจูู ุงูุนูููุงุช (ุถุฑุจ/ุฌูุน)
   - ูุฑุงุกุฉ ุฎุงุทุฆุฉ ููุณุคุงู
   - ุฎุทุฃ ูู ุชุฑุชูุจ ุงูุนูููุงุช
3. ุชุฃูุฏ ูู ูุฌูุฏ ุฅุฌุงุจุฉ ูุงุญุฏุฉ ุตุญูุญุฉ ููุท
4. ุงุณุชุฎุฏู ุฑููุฒ ุฑูุงุถูุฉ ุนุฑุจูุฉ: รุ รทุ =ุ โุ <ุ >ุ โคุ โฅ
5. ุงูุฃุฑูุงู ูุฌุจ ุฃู ุชููู ุณููุฉ ุงูุญุณุงุจ (ุชุฌูุจ ุงููุณูุฑ ุงููุนูุฏุฉ ูู ุงูุฃุณุฆูุฉ ุงูุณููุฉ)

${MATH_FORMATTING_RULES}
`;

const VERBAL_RULES = `
## ููุงุนุฏ ุงูุฃุณุฆูุฉ ุงูููุธูุฉ:
1. ุงุณุชุฎุฏู ูุบุฉ ุนุฑุจูุฉ ูุตูุญุฉ ุฎุงููุฉ ูู ุงูุฃุฎุทุงุก ุงููุญููุฉ ูุงูุฅููุงุฆูุฉ
2. ุงูุณูุงู ูุฌุจ ุฃู ูููู ูุงุถุญ ูููููู ูููุงุณุจ ูููุณุชูู
3. ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ ูุฌุจ ุฃู ุชููู:
   - ูุฑูุจุฉ ุงููุนูู ููู ุบูุฑ ุฏูููุฉ
   - ุชุญุชูู ุนูู ูุบุงูุทุงุช ููุทููุฉ ุดุงุฆุนุฉ
   - ุชุจุฏู ุตุญูุญุฉ ูููุฑุงุกุฉ ุงูุณุฑูุนุฉ
4. ุชุฌูุจ ุงูุบููุถ ูุงูุงุญุชูุงูุงุช ุงููุชุนุฏุฏุฉ
5. ุงุณุชุฎุฏู ููุฑุฏุงุช ูุชููุนุฉ ูููุงุณุจุฉ ูุงุฎุชุจุงุฑ ุงููุฏุฑุงุช
6. ุงููุตูุต ูุฌุจ ุฃู ุชููู ูู ูุตุงุฏุฑ ูุชููุนุฉ (ุนูููุฉุ ุฃุฏุจูุฉุ ุงุฌุชูุงุนูุฉ)
`;

const DISTRACTOR_GUIDELINES = `
## ุฅุฑุดุงุฏุงุช ุฅูุดุงุก ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ (Distractors):

### ููุฃุณุฆูุฉ ุงููููุฉ:
- ุฎูุงุฑ ููุซู ูุชูุฌุฉ ุนูููุฉ ุฎุงุทุฆุฉ ุดุงุฆุนุฉ
- ุฎูุงุฑ ููุซู ูุชูุฌุฉ ูุณูุงู ุฎุทูุฉ
- ุฎูุงุฑ ููุซู ูุฑุงุกุฉ ุฎุงุทุฆุฉ ูููุนุทูุงุช

### ููุฃุณุฆูุฉ ุงูููุธูุฉ:
- ุฎูุงุฑ ูุฑูุจ ูู ุงููุนูู ููู ุบูุฑ ุฏููู
- ุฎูุงุฑ ูุจุฏู ููุทููุงู ููู ูุชูุงูุถ ูุน ุงูุณูุงู
- ุฎูุงุฑ ูุณุชุฎุฏู ูููุงุช ูู ุงููุต ููู ุจูุนูู ุฎุงุทุฆ

### ููุงุนุฏ ุนุงูุฉ:
- ุงูุฎูุงุฑุงุช ูุชูุงุฑุจุฉ ูู ุงูุทูู ูุงูุชุนููุฏ
- ูุง ุชูุฌุฏ ุฃุฏูุฉ ูุบููุฉ ุชูุดู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
- ุชุฑุชูุจ ููุทูู (ุฃุฑูุงู ุชุตุงุนุฏูุ ุฃุญุฑู ุฃุจุฌุฏู ุฅู ุฃููู)
- ูู ุฎูุงุฑ ุฎุงุทุฆ ูู ูุจุฑุฑ ููุทูู ูุงุฎุชูุงุฑู
`;

const EXPLANATION_RULES = `
## โ๏ธ ููุงุนุฏ ุงูุดุฑุญ ุงูุฅูุฒุงููุฉ (ููู ุฌุฏุงู):

### ุงูุจููุฉ ุงููุทููุจุฉ:
1. **ุงุจุฏุฃ ุจู:** "ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู (X) ูุฃู..."
2. **ุงุฐูุฑ ูู ุฑูู ููุชูุฌุฉ ุจูุถูุญ ุชุงู** - ูุง ุชุชุฑู ุฃู ูููุฉ ูุงุฑุบุฉ ุฃู ูุงูุตุฉ
3. **ุฑููู ุฎุทูุงุช ุงูุญู:** ุงูุฎุทูุฉ ุงูุฃูููุ ุงูุฎุทูุฉ ุงูุซุงููุฉุ ...
4. **ุงุดุฑุญ ููุงุฐุง ูู ุฎูุงุฑ ุฎุงุทุฆ ุฎุงุทุฆ:**
   - "ุงูุฎูุงุฑ (ุฃ) ุฎุงุทุฆ ูุฃู..."
   - "ุงูุฎูุงุฑ (ุจ) ุฎุงุทุฆ ูุฃู..."
5. **ุงุฐูุฑ ุงููุงุนุฏุฉ/ุงูููููู ุงููุณุชุฎุฏู** ูู ููุงูุฉ ุงูุดุฑุญ

### ูุชุทูุจุงุช ุงูุฌูุฏุฉ:
- โ ุทูู ุงูุดุฑุญ: **100-300 ูููุฉ** (ูุง ุฃูู ูู 100 ูููุฉ)
- โ ูู ูุชูุฌุฉ ุญุณุงุจูุฉ ูุฌุจ ุฃู ุชููุชุจ ุตุฑูุญุฉ: "5 ร 4 = 20" ูููุณ "5 ร 4 = "
- โ ุงูุดุฑุญ ูุฌุจ ุฃู ูููู ูููููุงู ููุทุงูุจ ุงููุจุชุฏุฆ
- โ ุงุณุชุฎุฏู ุฃูุซูุฉ ุชูุถูุญูุฉ ุนูุฏ ุงูุญุงุฌุฉ

### ููููุน ูู ุงูุดุฑุญ:
- โ ุฌูู ุบูุฑ ููุชููุฉ ูุซู "ุงูุนุฏุฏ ูู" ุจุฏูู ุฐูุฑ ุงูุนุฏุฏ
- โ ูุชุงุฆุฌ ุญุณุงุจุงุช ูุงุฑุบุฉ ุฃู ูุงูุตุฉ
- โ ุดุฑุญ ุฃูู ูู 50 ูููุฉ
- โ ุนุฏู ุดุฑุญ ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ
- โ ุงุณุชุฎุฏุงู "..." ูุงุฎุชุตุงุฑ ุงูุดุฑุญ
- โ ุนุจุงุฑุงุช ูุจููุฉ ูุซู "ุจุงูุญุณุงุจ ูุฌุฏ ุฃู..." ุจุฏูู ุชูุงุตูู
`;

/**
 * Build an advanced, structured prompt for AI question generation
 */
export function buildAdvancedPrompt(config: PromptConfig): string {
  const { subTopic, difficulty, count, examples, section, topic } = config;
  const guidelines = DIFFICULTY_GUIDELINES[difficulty];
  const specificRules = section === 'ููู' ? QUANTITATIVE_RULES : VERBAL_RULES;

  const examplesSection = examples.length > 0 
    ? buildExamplesSection(examples, difficulty)
    : 'โ๏ธ ูุง ุชูุฌุฏ ุฃูุซูุฉ ูุชุงุญุฉ - ูููุฏ ุฃุณุฆูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุจูุงุกู ุนูู ุงููุนุงููุฑ ุฃุนูุงู ููุท.';

  return `ุฃูุช ุฎุจูุฑ ูุชุฎุตุต ูู ุตูุงุบุฉ ุฃุณุฆูุฉ ุงุฎุชุจุงุฑ ุงููุฏุฑุงุช ุงูุณุนูุฏู ุจูุนุงููุฑ ุงููุฑูุฒ ุงููุทูู ููููุงุณ.

## ๐ฏ ุงููููุฉ:
ูููุฏ **${count} ุฃุณุฆูุฉ ูุฑูุฏุฉ ูุนุงููุฉ ุงูุฌูุฏุฉ** ูู:
- **ุงููุณู:** ${section}
- **ุงูููุถูุน ุงูุฑุฆูุณู:** ${topic}
- **ุงูููุถูุน ุงููุฑุนู:** ${subTopic}
- **ุงููุณุชูู:** ${difficulty} (${guidelines.description})

## ๐ ูุนุงููุฑ ุงูุตุนูุจุฉ ุงููุทููุจุฉ:
| ุงููุนูุงุฑ | ุงููููุฉ |
|---------|--------|
| ุงููุณุชูู ุงููุนุฑูู | ${guidelines.cognitive_level} |
| ุนุฏุฏ ุงูุฎุทูุงุช | ${guidelines.steps} |
| ุงูููุช ุงููุชููุน | ${guidelines.time} |
| ุงูุชุนููุฏ | ${guidelines.complexity} |

${specificRules}

${DISTRACTOR_GUIDELINES}

${EXPLANATION_RULES}

## โ ูุนุงููุฑ ุงูุฌูุฏุฉ ุงูุฅูุฒุงููุฉ:

### 1. ูุญุชูู ุงูุณุคุงู:
- โ ูุฎุชุจุฑ **ุงูููู ูุงูุชุทุจูู** ูููุณ ุงูุญูุธ ููุท
- โ ูุงุถุญ ููุญุฏุฏ ุจุฏูู ุบููุถ ุฃู ุงุญุชูุงูุงุช ูุชุนุฏุฏุฉ
- โ ูุบุทู ุฌุงูุจ ููู ูู ุงูููุถูุน ุงููุฑุนู: ${subTopic}
- โ ูุณุชูู ุงูุตุนูุจุฉ ูุชุณู ูุน ุงููุทููุจ (${difficulty})
- โ ุงูุณุคุงู ูุฑุชุจุท ูุจุงุดุฑุฉ ุจุงูููุถูุน ุงููุญุฏุฏ

### 2. ุงูุฎูุงุฑุงุช (ุฃุ ุจุ ุฌุ ุฏ):
- โ ุฃุฑุจุนุฉ ุฎูุงุฑุงุช ููุท
- โ ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ **ูููุนุฉ ูููุทููุฉ** (ููุณุช ุณุฎููุฉ)
- โ ุงูุฎูุงุฑุงุช ูุชูุงุฑุจุฉ ูู ุงูุทูู ูุงูุชุนููุฏ
- โ ูุง ุชูุฌุฏ ุฃุฏูุฉ ูุบููุฉ ุฃู ููุทูุฉ ุชูุดู ุงูุฅุฌุงุจุฉ
- โ ุชุฑุชูุจ ููุทูู ููุฎูุงุฑุงุช

### 3. ุงูุดุฑุญ ุงูุชูุตููู (ููู ุฌุฏุงู):
- โ ูุจุฏุฃ ุจู "ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู (X) ูุฃู..."
- โ ูุดุฑุญ **ุฎุทูุงุช ุงูุญู ุจุงูุชูุตูู ุงููุงูู** ูุน ูู ุงูุฃุฑูุงู
- โ ููุถุญ **ููุงุฐุง ูู ุฎูุงุฑ ุฎุงุทุฆ ุฎุงุทุฆ** ุจุดูู ูููุตู
- โ ูุฐูุฑ ุงูููููู ุฃู ุงููุงุนุฏุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูููุงูุฉ
- โ **100-300 ูููุฉ** ุนูู ุงูุฃูู
- โ **ูุง ุชุชุฑู ุฃู ูุชูุฌุฉ ูุงุฑุบุฉ** - ุงูุชุจ ูู ุงูุฃุฑูุงู ุตุฑูุญุฉ

### 4. ุงูุชูุฑุฏ ูุงูุชููุน:
- โ ูู ุณุคุงู **ูุฎุชูู ุชูุงูุงู** ุนู ุงูุฃูุซูุฉ ูุงูุฃุณุฆูุฉ ุงูุฃุฎุฑู
- โ ูุง ุชูุฑุฑ ููุณ ุงูุฃุฑูุงู ุฃู ุงูุณููุงุฑูููุงุช
- โ ุงุณุชุฎุฏู ุณูุงูุงุช ูุฃูุซูุฉ ูุชููุนุฉ ูู ุงูุญูุงุฉ ุงููุงูุนูุฉ
- โ ุชูููุน ูู ุตูุงุบุฉ ุงูุฃุณุฆูุฉ

---

## ๐ ุฃูุซูุฉ ูููุฐุฌูุฉ ููุชุนูู ูููุง:
${examplesSection}

---

## ๐ค ุตูุบุฉ ุงูุฅุฎุฑุงุฌ (JSON ููุท):

**ุชุนูููุงุช ุญุงุณูุฉ:**
1. ุฃุฑุฌุน JSON array ููุท - ุจุฏูู ุฃู ูุต ูุจูู ุฃู ุจุนุฏู
2. ุจุฏูู markdown backticks (\`\`\`)
3. ุชุฃูุฏ ูู ุตุญุฉ JSON (escape ููุฃุญุฑู ุงูุฎุงุตุฉ)
4. ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูุฌุจ ุฃู ุชููู: "ุฃ" ุฃู "ุจ" ุฃู "ุฌ" ุฃู "ุฏ"

ุงูุตูุบุฉ ุงููุทููุจุฉ:
[
  {
    "question": "ูุต ุงูุณุคุงู ุงููุงูู ูุงููุงุถุญ",
    "options": {
      "ุฃ": "ุงูุฎูุงุฑ ุงูุฃูู",
      "ุจ": "ุงูุฎูุงุฑ ุงูุซุงูู", 
      "ุฌ": "ุงูุฎูุงุฑ ุงูุซุงูุซ",
      "ุฏ": "ุงูุฎูุงุฑ ุงูุฑุงุจุน"
    },
    "correctAnswer": "ุฃ",
    "explanation": "ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู (ุฃ) ูุฃู [ุงุดุฑุญ ุงูุณุจุจ ุจุงูุชูุตูู]. ุงูุฎุทูุฉ ุงูุฃููู: [ุงุฐูุฑ ุงูุฎุทูุฉ ูุน ุงูุฃุฑูุงู ุงููุงููุฉ]. ุงูุฎุทูุฉ ุงูุซุงููุฉ: [ุงุฐูุฑ ุงูุฎุทูุฉ]. ุงูุฎูุงุฑ (ุจ) ุฎุงุทุฆ ูุฃู [ุงูุณุจุจ]. ุงูุฎูุงุฑ (ุฌ) ุฎุงุทุฆ ูุฃู [ุงูุณุจุจ]. ุงูุฎูุงุฑ (ุฏ) ุฎุงุทุฆ ูุฃู [ุงูุณุจุจ]. ุงููุงุนุฏุฉ ุงููุณุชุฎุฏูุฉ: [ุงุฐูุฑ ุงููุงุนุฏุฉ ุฃู ุงูููููู].",
    "difficulty": "${difficulty}",
    "subTopic": "${subTopic}"
  }
]

๐ **ุงุจุฏุฃ ุงูุชูููุฏ ุงูุขู - ${count} ุฃุณุฆูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ูู ููุถูุน "${subTopic}":**`;
}

/**
 * Build the examples section of the prompt
 */
function buildExamplesSection(examples: TrainingExample[], targetDifficulty: string): string {
  return examples.map((ex, i) => {
    const insight = getInsightFromExample(ex, targetDifficulty);
    const optionsText = Object.entries(ex.options as Record<string, string>)
      .sort(([a], [b]) => a.localeCompare(b))
      .map(([key, val]) => `${key}) ${val}`)
      .join('\n');

    return `
### ๐น ูุซุงู ${i + 1}:
**ุงูููุถูุน ุงููุฑุนู:** ${ex.sub_topic || 'ุบูุฑ ูุญุฏุฏ'}
**ุงูุตุนูุจุฉ:** ${ex.difficulty}
${ex.quality_score ? `**ุฏุฑุฌุฉ ุงูุฌูุฏุฉ:** ${ex.quality_score}/5` : ''}

**ุงูุณุคุงู:**
${ex.question_text}

**ุงูุฎูุงุฑุงุช:**
${optionsText}

**โ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ:** ${ex.correct_answer}

**๐ก ุงูุดุฑุญ:**
${ex.explanation}

**๐ฏ ูุงุญุธ:** ${insight}

---`;
  }).join('\n');
}

/**
 * Get insight/tip based on the example and target difficulty
 */
function getInsightFromExample(example: TrainingExample, targetDifficulty: string): string {
  const insights: Record<string, Record<string, string>> = {
    easy: {
      easy: 'ุงูุณุคุงู ูุจุงุดุฑ ููุชุทูุจ ุฎุทูุฉ ูุงุญุฏุฉ ููุท - ุญุงูุธ ุนูู ูุฐู ุงูุจุณุงุทุฉ',
      medium: 'ูุฐุง ุงููุซุงู ุฃุตุนุจ ูู ุงููุทููุจ - ุงุฌุนู ุฃุณุฆูุชู ุฃุจุณุท ูุฃูุซุฑ ูุจุงุดุฑุฉ',
      hard: 'ูุฐุง ุงููุซุงู ูุนูุฏ ุฌุฏุงู - ุฑูุฒ ุนูู ุงูููุงููู ุงูุฃุณุงุณูุฉ ููุท'
    },
    medium: {
      easy: 'ูุฐุง ุงููุซุงู ุจุณูุท - ุฃุถู ุฎุทูุฉ ุซุงููุฉ ุฃู ุฑุจุท ุจูู ููููููู',
      medium: 'ูุณุชูู ููุงุณุจ - ุญุงูุธ ุนูู ุงูุชูุงุฒู ุจูู ุงููุถูุญ ูุงูุชุญุฏู',
      hard: 'ูุฐุง ุงููุซุงู ุตุนุจ - ููู ุงูุชุนููุฏ ููููุงู'
    },
    hard: {
      easy: 'ูุฐุง ุงููุซุงู ุจุณูุท ุฌุฏุงู - ุฃุถู ุชุนููุฏุงู ูุฎุทูุงุช ูุชุนุฏุฏุฉ',
      medium: 'ุฃุถู ูุณุชูู ูู ุงูุชุญููู ุงูุนููู ูุฑุจุท ุงูููุงููู',
      hard: 'ูุณุชูู ููุงุณุจ - ุญุงูุธ ุนูู ุงูุชุญุฏู ูุน ุงููุถูุญ'
    }
  };

  return insights[targetDifficulty]?.[example.difficulty] || 
    'ูุงุญุธ ุฃุณููุจ ุงูุตูุงุบุฉ ูุทุฑููุฉ ุจูุงุก ุงูุฎูุงุฑุงุช';
}

/**
 * Build a validation prompt for checking generated questions
 */
export function buildValidationPrompt(questions: any[], subTopic: string, section: string): string {
  return `ุฑุงุฌุน ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ ูุชุญูู ูู ุฌูุฏุชูุง:

## ูุนุงููุฑ ุงูุชูููู:
1. ูู ุงูุณุคุงู ูุฑุชุจุท ุจุงูููุถูุน "${subTopic}"ุ
2. ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุตุญูุญุฉ ูุนูุงูุ
3. ูู ุงูุฎูุงุฑุงุช ุงูุฎุงุทุฆุฉ ููุทููุฉ ููููุนุฉุ
4. ูู ุงูุดุฑุญ ูุงุถุญ ูููุตูุ
5. ูู ุงููุบุฉ ุงูุนุฑุจูุฉ ุณูููุฉุ

## ุงูุฃุณุฆูุฉ ูููุฑุงุฌุนุฉ:
${JSON.stringify(questions, null, 2)}

ุฃุฑุฌุน JSON ุจุงูุตูุบุฉ:
{
  "validQuestions": [indices of valid questions],
  "invalidQuestions": [{"index": 0, "reason": "ุงูุณุจุจ"}],
  "overallScore": 1-5
}`;
}
