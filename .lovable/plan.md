
# ๐ ุชูุฑูุฑ ูุญุต ุงููุดุฑูุน ุงูุดุงูู

---

## ๐ด ุงููุดุงูู ุงูุฃูููุฉ (ุงูุฃููููุฉ: ุนุงุฌูุฉ)

### 1. โ ุญูุงูุฉ ูููุงุช ุงููุฑูุฑ ุงููุณุฑุจุฉ ูุนุทูุฉ
- **ุงููุดููุฉ:** ุงููุณุชุฎุฏููู ูููููู ุงุณุชุฎุฏุงู ูููุงุช ูุฑูุฑ ูุฎุชุฑูุฉ
- **ุงูุญู:** ุชูุนูู "Leaked Password Protection" ูู ุฅุนุฏุงุฏุงุช Backend

### 2. โ ุชุณุฑูุจ ุจูุงูุงุช Google AdSense
- **ุงููุดููุฉ:** ุฌุฏูู `ad_settings` ูุชุงุญ ูููุฑุงุกุฉ ุงูุนุงูุฉ ูููุดู ูุนุฑู AdSense
- **ุงูุญู:** ุชุนุฏูู ุณูุงุณุฉ RLS ูุชูููุฏ ุงููุตูู ูููุณุคูููู ููุท

### 3. โ๏ธ ุชุณุฑูุจ ุจูุงูุงุช Stripe
- **ุงููุดููุฉ:** ุฌุฏูู `subscription_packages` ูุชุงุญ ูููุฑุงุกุฉ ุงูุนุงูุฉ
- **ุงูุญู:** ุชูููุฏ SELECT ูููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู ููุท

---

## ๐ ุงูุฃุฎุทุงุก ุงูุชูููุฉ

### 1. ุฎุทุฃ AdSense ูุชูุฑุฑ ูู Console
```
TagError: adsbygoogle.push() error: All 'ins' elements already have ads
```
- **ุงูุณุจุจ:** ูุญุงููุฉ ุชุญููู ุงูุฅุนูุงูุงุช ูุฑุฉ ุฃุฎุฑู ุนูุฏ ุฅุนุงุฏุฉ render
- **ุงูุญู:** ุฅุถุงูุฉ ุชุญูู ูุจู push ูููุน ุงูุชูุฑุงุฑ

### 2. ููุต ุฃูุซูุฉ ุงูุชุฏุฑูุจ
- **ุงูุญุงูุฉ ุงูุญุงููุฉ:** 12 ูุซุงู ููุท ูู `ai_training_examples`
- **ุงููุทููุจ:** 100+ ูุซุงู ุนูู ุงูุฃูู (5 ููู ููุถูุน ูุฑุนู ร 37 ููุถูุน)
- **ุงูุชุฃุซูุฑ:** ุฌูุฏุฉ ุงูุฃุณุฆูุฉ ุงููููุฏุฉ ููุฎูุถุฉ

### 3. ููุต ุงูุชููุน ูู ุตุนูุจุฉ ุงูุฃุณุฆูุฉ
- **ุงูุญุงูุฉ ุงูุญุงููุฉ:** ุฌููุน ุงูุฃุณุฆูุฉ (760+) ุจูุณุชูู `medium` ููุท
- **ุงูููุต:** ูุง ุชูุฌุฏ ุฃุณุฆูุฉ `easy` ุฃู `hard`
- **ุงูุญู:** ุชูููุฏ ุฃุณุฆูุฉ ูุชููุนุฉ ุงูุตุนูุจุฉ

---

## ๐ก ุงูููุงูุต ุงููุธูููุฉ

| ุงูููุถูุน | ุงูุญุงูุฉ | ุงูุฅุฌุฑุงุก ุงููุทููุจ |
|---------|--------|-----------------|
| ุงููุชุชุงููุงุช ุงูุญุณุงุจูุฉ | โ ููุฌูุฏ | - |
| ุงููุชุชุงููุงุช ุงูููุฏุณูุฉ | โ ูุงูุต | ุชูููุฏ 20 ุณุคุงู |
| ุงูุดุงุฐ ุงููุฎุชูู | โ ูุงูุต | ุชูููุฏ 20 ุณุคุงู |
| ุงูููุงุณ ุงูููุทูู | โ ูุงูุต | ุชูููุฏ 20 ุณุคุงู |
| ุงูุงุณุชูุชุงุฌ ุงูููุทูู | โ ูุงูุต | ุชูููุฏ 20 ุณุคุงู |

---

## ๐ข ุงูุชุญุณูู ุงููุทููุจ: ุงูุฐูุงุก ุงูุงุตุทูุงุนู ููุชุจ ุงูุฏูุงู ุจุงูุนุฑุจูุฉ ูุงูุฃูุณ

### ุงููุดููุฉ ุงูุญุงููุฉ:
```
ุณ^2 + 5ุณ - 6 = 0  โ ุบูุฑ ูุงุถุญ
```

### ุงููุทููุจ:
```
ุณยฒ + 5ุณ - 6 = 0  โ ูุงุถุญ ููููู
```

### ุงูุชุนุฏููุงุช ุงููุทููุจุฉ:

#### 1. ุชุญุฏูุซ `advancedPromptBuilder.ts`
ุฅุถุงูุฉ ููุงุนุฏ ุงูุชูุณูู ุงูุฑูุงุถู:

```typescript
const MATH_FORMATTING_RULES = `
## ููุงุนุฏ ูุชุงุจุฉ ุงูุฑูุงุถูุงุช:
1. **ุงูุฃูุณูุณ**: ุงูุชุจ ุงูุฃุณ ูู superscript
   - โ x^2, ุณ^2
   - โ xยฒ, ุณยฒ
   - ุงูุฃูุณูุณ ุงููุชุงุญุฉ: โฐยนยฒยณโดโตโถโทโธโน
   
2. **ุงููุชุบูุฑุงุช**: ุงุณุชุฎุฏู ุงูุญุฑูู ุงูุนุฑุจูุฉ
   - โ x, y, z
   - โ ุณุ ุตุ ุน
   
3. **ุงูุฌุฐูุฑ**: ุงุณุชุฎุฏู ุฑูุฒ ุงูุฌุฐุฑ
   - โ sqrt(4)
   - โ โ4
   
4. **ุงููุณูุฑ**: ุงุณุชุฎุฏู ุฎุท ุงููุณุฑ
   - โ 1/2, a/b
   - โ ยฝ ุฃู (ุฃ รท ุจ)

5. **ุงูุฑููุฒ ุงูุฑูุงุถูุฉ**:
   | ุงูุฑูุฒ | ุงูุงุณุชุฎุฏุงู |
   |------|----------|
   | ร | ุงูุถุฑุจ |
   | รท | ุงููุณูุฉ |
   | ยฑ | ุฒุงุฆุฏ ุฃู ูุงูุต |
   | โค | ุฃุตุบุฑ ุฃู ูุณุงูู |
   | โฅ | ุฃูุจุฑ ุฃู ูุณุงูู |
   | โ | ูุง ูุณุงูู |
   | ฯ | ุจุงู |
   | โ | ูุง ูุง ููุงูุฉ |
`;
```

#### 2. ุฅูุดุงุก ุฏุงูุฉ ุชุญููู ุงูุชูุณูู
ููู ุฌุฏูุฏ: `src/lib/mathFormatter.ts`

```typescript
// ุชุญููู ุงูุฃุณุณ ุฅูู superscript
export function formatMathExponents(text: string): string {
  const superscripts: Record<string, string> = {
    '0': 'โฐ', '1': 'ยน', '2': 'ยฒ', '3': 'ยณ', '4': 'โด',
    '5': 'โต', '6': 'โถ', '7': 'โท', '8': 'โธ', '9': 'โน',
    'n': 'โฟ', '+': 'โบ', '-': 'โป'
  };
  
  // ุชุญููู ^digit ุฅูู superscript
  return text.replace(/\^([0-9n\+\-]+)/g, (_, exp) => 
    exp.split('').map((c: string) => superscripts[c] || c).join('')
  );
}

// ุชุญููู ุงููุชุบูุฑุงุช ุงูุฅูุฌููุฒูุฉ ุฅูู ุนุฑุจูุฉ
export function arabicVariables(text: string): string {
  const vars: Record<string, string> = {
    'x': 'ุณ', 'y': 'ุต', 'z': 'ุน',
    'a': 'ุฃ', 'b': 'ุจ', 'c': 'ุฌ',
    'n': 'ู', 'm': 'ู', 'r': 'ุฑ'
  };
  
  // ุชุญููู ุงููุชุบูุฑุงุช ุงููููุฑุฏุฉ ููุท
  return text.replace(/\b([xyz])\b/gi, (_, v) => 
    vars[v.toLowerCase()] || v
  );
}

// ุชูุณูู ูุงูู ูููุต ุงูุฑูุงุถู
export function formatMathText(text: string): string {
  let result = text;
  result = formatMathExponents(result);
  result = arabicVariables(result);
  result = result.replace(/\*/g, 'ร');
  result = result.replace(/\//g, 'รท');
  result = result.replace(/sqrt\(([^)]+)\)/g, 'โ$1');
  return result;
}
```

#### 3. ุชุทุจูู ุงูุชูุณูู ูู `MessageContent.tsx`
ุชูุณูู ุงูุฑุฏ ูุจู ุงูุนุฑุถ:

```typescript
import { formatMathText } from '@/lib/mathFormatter';

// ูู ุฏุงูุฉ render
const formattedContent = formatMathText(content);
```

#### 4. ุชุญุฏูุซ System Prompt ูู `ai-tutor/index.ts`
ุฅุถุงูุฉ ุชุนูููุงุช ูุงุถุญุฉ ููู AI:

```typescript
const MATH_INSTRUCTIONS = `
## ุชุนูููุงุช ุงููุชุงุจุฉ ุงูุฑูุงุถูุฉ:
- ุงูุชุจ ุงููุชุบูุฑุงุช ุจุงูุนุฑุจูุฉ: ุณุ ุตุ ุน
- ุงูุชุจ ุงูุฃูุณ ูู superscript: ุณยฒ ูููุณ ุณ^2
- ุงุณุชุฎุฏู ุงูุฑููุฒ: รุ รทุ โุ ฯ
- ูุซุงู: "ุงููุนุงุฏูุฉ ุณยฒ + 5ุณ - 6 = 0"
- ูุซุงู: "ุงูุฌุฐุฑ ุงูุชุฑุจูุนู ูู 16 ูู โ16 = 4"
`;
```

---

## ๐ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุฅุตูุงุญุงุช ุฃูููุฉ (ุนุงุฌูุฉ)
1. ุชูุนูู Leaked Password Protection ูู ุงูุฅุนุฏุงุฏุงุช
2. ุชุนุฏูู RLS ูู `ad_settings` ู `subscription_packages`

### ุงููุฑุญูุฉ 2: ุฅุตูุงุญ ุฃุฎุทุงุก Console
1. ุชุนุฏูู `GoogleAd.tsx` ูููุน ุชูุฑุงุฑ push

### ุงููุฑุญูุฉ 3: ุชุญุณูู ุชูุณูู ุงูุฑูุงุถูุงุช
1. ุฅูุดุงุก `src/lib/mathFormatter.ts`
2. ุชุญุฏูุซ `advancedPromptBuilder.ts`
3. ุชุญุฏูุซ `ai-tutor/index.ts`
4. ุชุทุจูู ุงูุชูุณูู ูู `MessageContent.tsx`

### ุงููุฑุญูุฉ 4: ุชุญุณูู ุฌูุฏุฉ ุงูุฃุณุฆูุฉ
1. ุฅุถุงูุฉ ุฃูุซูุฉ ุชุฏุฑูุจ (ูู 12 ุฅูู 100+)
2. ุชูููุฏ ุฃุณุฆูุฉ easy ู hard
3. ููุก ุงูููุถูุนุงุช ุงููุงูุตุฉ

---

## ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ

| ุงูููู | ุงูุชุบููุฑ |
|------|---------|
| `src/lib/mathFormatter.ts` | **ุฌุฏูุฏ** - ุฏูุงู ุชูุณูู ุงูุฑูุงุถูุงุช |
| `src/components/MessageContent.tsx` | ุชุทุจูู formatMathText |
| `supabase/functions/_shared/advancedPromptBuilder.ts` | ุฅุถุงูุฉ MATH_FORMATTING_RULES |
| `supabase/functions/ai-tutor/index.ts` | ุฅุถุงูุฉ ุชุนูููุงุช ุงูุฑูุงุถูุงุช |
| `src/components/GoogleAd.tsx` | ุฅุตูุงุญ ุฎุทุฃ ุงูุชูุฑุงุฑ |

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

**ูุจู:**
```
ุญู ุงููุนุงุฏูุฉ x^2 + 5x - 6 = 0
ุงูุฎุทูุฉ 1: ูุฌุฏ ุนูุงูู ุงูุนุฏุฏ -6
ุงูุฎุทูุฉ 2: (x+6)(x-1) = 0
ุฅุฐู x = -6 ุฃู x = 1
```

**ุจุนุฏ:**
```
ุญู ุงููุนุงุฏูุฉ ุณยฒ + 5ุณ - 6 = 0
ุงูุฎุทูุฉ ุงูุฃููู: ูุฌุฏ ุนูุงูู ุงูุนุฏุฏ -6
ุงูุฎุทูุฉ ุงูุซุงููุฉ: (ุณ+6)(ุณ-1) = 0
ุฅุฐู ุณ = -6 ุฃู ุณ = 1
```

